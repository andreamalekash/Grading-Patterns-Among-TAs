---
title: "Exploring TA Grading Patterns"
author: "Andrea Malek Ash"
date: "12/6/2020"
output:
  html_document: default
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

Load packages
```{r packages}
if (!require("stats", "psych", "agricolae", "graphics"))install.packages("stats", "psych", "agricolae", "graphics", repos = 'http://cran.us.r-project.org')
library("stats")
library("psych")
library("agricolae")
library("graphics")
```

Load data. Save student scores as csv file (rows = Students, columns = Score, TA)
```{r Load}
scores <- read.csv("/Users/andreaash/Student scores.csv", header=TRUE) 
scores$TA <- factor(scores$TA) #if your TA identifiers are numeric, this will make them factors
```

Get a summary of each groups's mean and variance 
```{r summary}
group.summary <- describeBy(x = scores$Score, group = scores$TA, mat=TRUE) #"mat=TRUE" creates a data frame
print(group.summary)
```
Make a boxplot to visualize your data and get a sense of the difference between TA's
```{r plot}
boxplot(Score ~ TA, data = scores)
```

Use a simple ANOVA to compare groups of students graded by the same TA
```{r anova}
model.TA <- aov(Score ~ TA, data= scores)
```

Checking ANOVA assumptions and possible problem spots

```{r assumptions}
plot(model.TA,1) #Homogeneity of variance - do some score groups vary more widely than others?  
plot(model.TA,2) #Normality of score distribution -  check whether the data are normally distributed. 
```
ANOVA is fairly robust to violations of homogeneity of variance. Most likely you can use Plot 1 for informational purposes only, to help you understand differences in variance between groups.

If scores are not normal (likely in course grading!)
```{r skewness}
skewness(scores$Score) #Check existing skewness of score distribution
scores$Score.log10 <- log10(scores$Score) #Use a transformation of your choosing (log10 is used here)
skewness(scores$Score.log10) #Check the skewness again - if improved and the transformation makes sense, use this transformed value as your dependent value in the ANOVA
```
Repeat the ANOVA with new outcome variable, if you'd like.
```{r revised anova}
model.TA.log10 <- aov(Score.log10 ~ TA, data= scores)
```
Remember that TA's are still confounded with student groups - you can't interpret a TA effect on its own at this point.

If significant p-value, you can continue with post-hoc analysis to get a more detailed picture of mean differences.
```{r post-hoc}
print(TukeyHSD(x = model.TA))
```
Remember, group differences could be due to TA's OR other factors like lab section, lab time, student schedules, etc. We don't know and can't interpret this - it's only for informational purposes to help understand patterns in the data.
